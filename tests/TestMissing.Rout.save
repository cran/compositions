
R version 4.1.2 (2021-11-01) -- "Bird Hippie"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("compositions")
Welcome to compositions, a package for compositional data analysis.
Find an intro with "? compositions"


Attaching package: ‘compositions’

The following objects are masked from ‘package:stats’:

    anova, cor, cov, dist, var

The following object is masked from ‘package:graphics’:

    segments

The following objects are masked from ‘package:base’:

    %*%, norm, scale, scale.default

> set.seed(1334345)
> data(SimulatedAmounts)
> par(pch=20)
> mydata <- simulateMissings(sa.groups5,dl=0.01,knownlimit=TRUE,MAR=0.05,MNARprob=0.05,SZprob=0.05)
> 
> 
> cdata <- acomp(mydata)
Warning message:
In acomp(mydata) :
  Negative values in composition are used as detection limits
> cdata
      Cu            Zn           Pb             Cd              Co             
 [1,] "0.025707633" "0.03643146" "0.8941291179" " 1.043489e-02" " 3.329690e-02"
 [2,] "0.002823595" "0.03806539" "0.6767266974" " 5.233545e-02" " 2.300489e-01"
 [3,] "0.016021341" "0.10961981" "0.8743588467" "<5.269740e-04" "<5.269740e-04"
 [4,] "0.036751418" "       MAR" "0.9590864323" " 1.212074e-03" " 2.950076e-03"
 [5,] "0.031228176" "0.06478130" "0.9038356221" "         MNAR" " 1.549035e-04"
 [6,] "0.094265333" "0.13128330" "0.7744513679" "           SZ" "          MAR"
 [7,] "0.045414210" "0.21676984" "0.7350501198" " 9.575688e-04" " 1.808258e-03"
 [8,] "0.015051926" "0.13014259" "0.8495954565" " 1.774087e-03" " 3.435944e-03"
 [9,] "0.023557989" "0.08628553" "0.8894437402" "          MAR" " 7.127360e-04"
[10,] "0.046366661" "0.18292516" "0.7459267972" " 4.855792e-03" " 1.992559e-02"
[11,] "0.030384679" "0.12097095" "0.8484870671" "<3.796757e-05" " 1.572995e-04"
[12,] "0.004677034" "0.01131463" "0.9808424318" " 8.244257e-04" " 2.341481e-03"
[13,] "0.007311120" "0.01762118" "0.9750676966" "         MNAR" "<9.384200e-05"
[14,] "0.015242934" "0.06559599" "0.9191610774" "         MNAR" "           SZ"
[15,] "0.025594023" "0.04567862" "0.9246102010" " 1.194793e-03" " 2.922366e-03"
[16,] "0.296443253" "0.31615112" "0.2927788273" " 3.582794e-02" " 5.879886e-02"
[17,] "0.248760013" "0.38666433" "         MAR" "          MAR" " 3.645757e-01"
[18,] "0.042507679" "0.07340114" "0.8792025014" " 8.319839e-04" " 4.056693e-03"
[19,] "0.038913897" "0.10718908" "0.8440090605" " 2.971185e-03" " 6.916774e-03"
[20,] "0.169898872" "0.41153637" "0.3192338168" " 3.960814e-02" " 5.972281e-02"
[21,] "0.346366612" "0.59914466" "0.0544887250" "         MNAR" "<2.028137e-04"
[22,] "       MNAR" "0.22656313" "0.7725473225" "         MNAR" " 8.895456e-04"
[23,] "0.403340691" "0.57379224" "0.0221005903" " 7.664739e-04" "           SZ"
[24,] "         SZ" "0.99142126" "          SZ" " 6.444118e-03" " 2.134621e-03"
[25,] "0.259407999" "0.66397782" "0.0726755686" "          MAR" " 3.938611e-03"
[26,] "0.237816617" "0.58186649" "0.1791736366" " 1.143255e-03" "         MNAR"
[27,] "0.814775993" "        SZ" "0.1721117021" " 1.311230e-02" "         MNAR"
[28,] "0.073518873" "0.29171359" "0.6328466335" "         MNAR" " 1.920908e-03"
[29,] "0.193080981" "0.32553302" "0.4813860022" "<2.664045e-04" "<2.664045e-04"
[30,] "0.137161507" "0.49346235" "0.1262147251" " 1.962837e-01" " 4.687772e-02"
[31,] "0.111117171" "0.86082957" "0.0267072309" "           SZ" " 1.346028e-03"
[32,] "        MAR" "0.65975341" "0.2759764549" " 4.711820e-02" " 1.715194e-02"
[33,] "0.017059650" "0.10398122" "0.8751200168" " 3.193523e-03" " 6.455902e-04"
[34,] "        MAR" "0.55301265" "0.4465040678" " 4.832814e-04" "<1.649183e-04"
[35,] "0.179542248" "0.59951369" "0.2209440588" "          MAR" "<3.945291e-04"
[36,] "0.189886426" "0.32240436" "0.4719551740" " 1.035730e-02" " 5.396731e-03"
[37,] "0.114140952" "0.49657931" "0.3845670172" " 2.854052e-03" " 1.858667e-03"
[38,] "0.165514761" "0.11752629" "0.7169589481" "<9.907019e-05" "<9.907019e-05"
[39,] "0.197920058" "0.63609342" "0.1659865170" "          MAR" "          MAR"
[40,] "0.317223962" "0.60869330" "          SZ" " 7.408274e-02" "           SZ"
[41,] "0.179951965" "0.80253489" "0.0134339418" " 3.617760e-03" " 4.614417e-04"
[42,] "        MAR" "0.99798599" "0.0020140133" "         MNAR" "         MNAR"
[43,] "0.098303161" "0.78001715" "0.1179230373" " 3.035157e-03" " 7.214930e-04"
[44,] "0.056530869" "0.33612559" "0.0142737775" " 5.930698e-01" "           SZ"
[45,] "0.042824195" "0.93975590" "0.0018639968" " 1.369969e-02" " 1.856224e-03"
[46,] "0.045973462" "0.94622012" "0.0071749009" " 5.435390e-04" " 8.798179e-05"
[47,] "         SZ" "0.94095796" "0.0165693013" " 4.247274e-02" "         MNAR"
[48,] "0.041319850" "0.84287121" "0.0131916717" "           SZ" " 1.026173e-01"
[49,] "0.038874054" "0.94001457" "0.0079907027" " 1.157016e-02" " 1.550513e-03"
[50,] "0.132514868" "0.86719219" "0.0002333100" " 5.963531e-05" "<1.266900e-05"
[51,] "0.079504084" "0.80237211" "0.0134767533" " 8.853465e-02" " 1.611240e-02"
[52,] "0.047088550" "0.94999577" "0.0008309680" " 1.914018e-03" " 1.706902e-04"
[53,] "0.101504083" "0.89236770" "0.0056924052" " 3.524936e-04" " 8.332227e-05"
[54,] "0.159039041" "0.83500845" "0.0059525091" "           SZ" "         MNAR"
[55,] "0.071745979" "0.44722880" "0.0080950802" " 4.131260e-01" " 5.980414e-02"
[56,] "0.115202196" "0.87377137" "0.0003904268" " 9.659659e-03" " 9.763446e-04"
[57,] "0.081108589" "0.91802503" "0.0008055710" " 6.080595e-05" "         MNAR"
[58,] "0.033306898" "0.95483424" "0.0118588628" "           SZ" "<8.889540e-05"
[59,] "0.041409246" "0.93038002" "         MAR" " 2.445150e-02" " 3.759227e-03"
[60,] "0.294617957" "       MAR" "0.0082785534" " 6.053351e-01" " 9.176842e-02"
attr(,"class")
[1] "acomp"
> mean(cdata)
           Cu            Zn            Pb            Cd            Co 
"0.136537179" "0.650471225" "0.193404813" "0.012412507" "0.007174275" 
attr(,"class")
[1] "acomp"
Warning message:
In acomp(x) : Negative values in composition are used as detection limits
> mean(acomp(sa.groups5))
           Cu            Zn            Pb            Cd            Co 
"0.141647429" "0.659658588" "0.190494272" "0.005344234" "0.002855477" 
attr(,"class")
[1] "acomp"
> plot(acomp(sa.groups5))
> plot(mean(cdata),add=T,col="red")
Warning message:
In acomp(x) : Negative values in composition are used as detection limits
> plot(mean(acomp(sa.groups5)),add=T,col="green")
> mean(cdata - mean(cdata))
    Cu     Zn     Pb     Cd     Co 
" 0.2" " 0.2" " 0.2" " 0.2" " 0.2" 
attr(,"class")
[1] "acomp"
Warning messages:
1: In acomp(x) :
  Negative values in composition are used as detection limits
2: In acomp(gsi.div(x, y)) :
  Negative values in composition are used as detection limits
3: In acomp(x) :
  Negative values in composition are used as detection limits
> mm <-mean(cdata)
Warning message:
In acomp(x) : Negative values in composition are used as detection limits
> erg <-var(cdata)
> print(erg)
           Cu          Zn         Pb          Cd         Co
Cu  1.4584600  1.65184942 -1.3766795 -0.33655679 -1.3970731
Zn  1.6518494  2.68214514 -2.5332217  0.03317017 -1.8339431
Pb -1.3766795 -2.53322167  5.4296947 -2.08907090  0.5692774
Cd -0.3365568  0.03317017 -2.0890709  1.63133485  0.7611227
Co -1.3970731 -1.83394307  0.5692774  0.76112267  1.9006161
> svd(erg)
$d
[1] 8.412440e+00 4.201802e+00 3.119081e-01 1.761007e-01 7.156429e-17

$u
           [,1]       [,2]       [,3]       [,4]      [,5]
[1,] -0.3075737  0.3424609  0.6985826 -0.3163878 0.4472136
[2,] -0.4997854  0.3365634 -0.4535459  0.4808698 0.4472136
[3,]  0.7465851  0.4143280 -0.2251489 -0.1423061 0.4472136
[4,] -0.1891317 -0.5408317 -0.3672873 -0.5803708 0.4472136
[5,]  0.2499058 -0.5525206  0.3473995  0.5581950 0.4472136

$v
           [,1]       [,2]       [,3]       [,4]       [,5]
[1,] -0.3075737  0.3424609  0.6985826 -0.3163878 -0.4472136
[2,] -0.4997854  0.3365634 -0.4535459  0.4808698 -0.4472136
[3,]  0.7465851  0.4143280 -0.2251489 -0.1423061 -0.4472136
[4,] -0.1891317 -0.5408317 -0.3672873 -0.5803708 -0.4472136
[5,]  0.2499058 -0.5525206  0.3473995  0.5581950 -0.4472136

> ellipses(mm,erg)
> ellipses(mean(acomp(sa.groups5)),var(acomp(sa.groups5)))
> 
> cdata <- acomp(mydata)
Warning message:
In acomp(mydata) :
  Negative values in composition are used as detection limits
> plot(cdata)
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(cdata),add=T,col="blue")
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(acomp(sa.groups5)),add=T,col="green")
There were 50 or more warnings (use warnings() to see the first 50)
> mean(cdata - mean(cdata))
    Cu     Zn     Pb     Cd     Co 
" 0.2" " 0.2" " 0.2" " 0.2" " 0.2" 
attr(,"class")
[1] "acomp"
Warning messages:
1: In acomp(x) :
  Negative values in composition are used as detection limits
2: In acomp(gsi.div(x, y)) :
  Negative values in composition are used as detection limits
3: In acomp(x) :
  Negative values in composition are used as detection limits
> mm <-mean(cdata)
Warning message:
In acomp(x) : Negative values in composition are used as detection limits
> #erg <-var(cdata)
> svd(erg)
$d
[1] 8.412440e+00 4.201802e+00 3.119081e-01 1.761007e-01 7.156429e-17

$u
           [,1]       [,2]       [,3]       [,4]      [,5]
[1,] -0.3075737  0.3424609  0.6985826 -0.3163878 0.4472136
[2,] -0.4997854  0.3365634 -0.4535459  0.4808698 0.4472136
[3,]  0.7465851  0.4143280 -0.2251489 -0.1423061 0.4472136
[4,] -0.1891317 -0.5408317 -0.3672873 -0.5803708 0.4472136
[5,]  0.2499058 -0.5525206  0.3473995  0.5581950 0.4472136

$v
           [,1]       [,2]       [,3]       [,4]       [,5]
[1,] -0.3075737  0.3424609  0.6985826 -0.3163878 -0.4472136
[2,] -0.4997854  0.3365634 -0.4535459  0.4808698 -0.4472136
[3,]  0.7465851  0.4143280 -0.2251489 -0.1423061 -0.4472136
[4,] -0.1891317 -0.5408317 -0.3672873 -0.5803708 -0.4472136
[5,]  0.2499058 -0.5525206  0.3473995  0.5581950 -0.4472136

> ellipses(mm,erg)
There were 50 or more warnings (use warnings() to see the first 50)
> ellipses(mm,erg,r=2)
There were 50 or more warnings (use warnings() to see the first 50)
> 
> 
> 
> #cdata <- rcomp(mydata)
> #cdata
> 
> #mean(cdata)
> #mean(rcomp(sa.groups5))
> #plot(rcomp(sa.groups5))
> #plot(mean(cdata),add=T,col="red",pch=20)
> #plot(mean(rcomp(sa.groups5)),add=T,col="green",pch=20)
> #mean(cdata - mean(cdata)) # Nonsense because the difference is noncompositional
> 
> 
> cdata <- aplus(mydata)
> cdata
      Cu             Zn             Pb            Cd             Co           
 [1,] "  2.32560998" "   3.2957280" " 80.8863102" "  0.94398005" " 3.01216337"
 [2,] "  0.05819293" "   0.7845092" " 13.9470095" "  1.07860821" " 4.74119583"
 [3,] "  0.30402525" "   2.0801748" " 16.5920669" "<0.01000000"  "<0.01000000"
 [4,] "  2.90108035" "         MAR" " 75.7082851" "  0.09567857" " 0.23287289"
 [5,] "  5.74951568" "  11.9270845" "166.4079616" "        MNAR" " 0.02851976"
 [6,] "  3.09984060" "   4.3171470" " 25.4672180" "          SZ" "        MAR"
 [7,] "  2.95684364" "  14.1135236" " 47.8578897" "  0.06234571" " 0.11773265"
 [8,] "  3.06234225" "  26.4777503" "172.8517697" "  0.36094134" " 0.69904915"
 [9,] "  3.08324786" "  11.2929712" "116.4095761" "         MAR" " 0.09328223"
[10,] "  2.07666904" "   8.1928484" " 33.4085541" "  0.21748113" " 0.89242687"
[11,] "  8.00279898" "  31.8616572" "223.4768193" "<0.01000000"  " 0.04142996"
[12,] "  0.79144603" "   1.9146573" "165.9778114" "  0.13950902" " 0.39622464"
[13,] "  0.77908829" "   1.8777502" "103.9052563" "        MNAR" "<0.01000000"
[14,] "  0.41623431" "   1.7912103" " 25.0992607" "        MNAR" "         SZ"
[15,] "  3.20107658" "   5.7130820" "115.6421587" "  0.14943429" " 0.36550397"
[16,] "  8.12173391" "   8.6616754" "  8.0213387" "  0.98158755" " 1.61092791"
[17,] "  3.34773718" "   5.2036119" "        MAR" "         MAR" " 4.90634916"
[18,] "  3.90181325" "   6.7375485" " 80.7026878" "  0.07636845" " 0.37236699"
[19,] "  2.89945563" "   7.9866066" " 62.8867060" "  0.22138159" " 0.51536549"
[20,] "  6.56268069" "  15.8964079" " 12.3310390" "  1.52994294" " 2.30691173"
[21,] " 17.07806483" "  29.5416217" "  2.6866388" "        MNAR" "<0.01000000"
[22,] "        MNAR" "   4.3183778" " 14.7250399" "        MNAR" " 0.01695507"
[23,] " 20.54410986" "  29.2260393" "  1.1256909" "  0.03904026" "         SZ"
[24,] "          SZ" "  35.4935764" "         SZ" "  0.23070396" " 0.07642094"
[25,] " 16.10576105" "  41.2241264" "  4.5121791" "         MAR" " 0.24453498"
[26,] " 22.77938611" "  55.7343791" " 17.1622383" "  0.10950726" "       MNAR"
[27,] " 23.58064507" "          SZ" "  4.9811298" "  0.37948663" "       MNAR"
[28,] "  1.83244165" "   7.2708966" " 15.7735623" "        MNAR" " 0.04787820"
[29,] "  7.24766118" "  12.2194998" " 18.0697375" "<0.01000000"  "<0.01000000"
[30,] "  7.63069488" "  27.4527504" "  7.0216935" " 10.91983495" " 2.60794446"
[31,] " 26.62950316" " 206.2999218" "  6.4004535" "          SZ" " 0.32257893"
[32,] "         MAR" "  22.4674773" "  9.3982004" "  1.60457988" " 0.58409817"
[33,] "  0.81109644" "   4.9437589" " 41.6073436" "  0.15183519" " 0.03069441"
[34,] "         MAR" "  33.5325182" " 27.0742554" "  0.02930429" "<0.01000000"
[35,] "  4.55079806" "  15.1956755" "  5.6001961" "         MAR" "<0.01000000"
[36,] "  4.97063214" "   8.4395369" " 12.3543088" "  0.27112180" " 0.14126952"
[37,] "  2.20930598" "   9.6117618" "  7.4436580" "  0.05524286" " 0.03597626"
[38,] " 16.70681690" "  11.8629313" " 72.3687834" "<0.01000000"  "<0.01000000"
[39,] " 14.48399049" "  46.5499617" " 12.1470616" "         MAR" "        MAR"
[40,] "  3.66342116" "   7.0294182" "         SZ" "  0.85553525" "         SZ"
[41,] " 10.95300809" "  48.8473197" "  0.8176742" "  0.22019960" " 0.02808624"
[42,] "         MAR" " 615.2700400" "  1.2416628" "        MNAR" "       MNAR"
[43,] "  3.89677070" "  30.9201450" "  4.6745093" "  0.12031465" " 0.02860023"
[44,] " 19.81539452" " 117.8198968" "  5.0032936" "207.88485371" "         SZ"
[45,] " 13.87302392" " 304.4366853" "  0.6038472" "  4.43805373" " 0.60132928"
[46,] " 11.75363784" " 241.9119212" "  1.8343449" "  0.13896191" " 0.02249354"
[47,] "          SZ" "  80.2172745" "  1.4125437" "  3.62082849" "       MNAR"
[48,] "  5.03541513" " 102.7159212" "  1.6075940" "          SZ" "12.50538258"
[49,] "  5.79177975" " 140.0511873" "  1.1905213" "  1.72381849" " 0.23100839"
[50,] "104.59774771" " 684.4994158" "  0.1841582" "  0.04707184" "<0.01000000"
[51,] "  6.42154600" "  64.8076064" "  1.0885176" "  7.15094526" " 1.30139867"
[52,] " 60.77708084" "1226.1573067" "  1.0725284" "  2.47041878" " 0.22030942"
[53,] " 66.57712168" " 585.3091893" "  3.7336819" "  0.23120261" " 0.05465156"
[54,] " 16.86023960" "  88.5219277" "  0.6310446" "          SZ" "       MNAR"
[55,] "  6.27202842" "  39.0967097" "  0.7076713" " 36.11544583" " 5.22807356"
[56,] " 58.91700620" " 446.8664238" "  0.1996731" "  4.94016780" " 0.49932471"
[57,] " 33.98383856" " 384.6450147" "  0.3375277" "  0.02547720" "       MNAR"
[58,] "  3.74675153" " 107.4109817" "  1.3340243" "          SZ" "<0.01000000"
[59,] "  7.16929149" " 161.0791359" "        MAR" "  4.23335288" " 0.65084480"
[60,] " 26.39789963" "         MAR" "  0.7417621" " 54.23829107" " 8.22249084"
attr(,"class")
[1] "aplus"
> mean(cdata)
[1] " 5.9688392" "26.9654212" " 8.2389925" " 0.5742044" " 0.3264231"
attr(,"class")
[1] "aplus"
> mean(aplus(sa.groups5))
          Cu           Zn           Pb           Cd           Co 
" 6.1194322" "28.4984768" " 8.2297065" " 0.2308808" " 0.1233619" 
attr(,"class")
[1] "aplus"
> plot(aplus(sa.groups5))
> plot(mean(cdata),add=T,col="red",pch=20)
> plot(mean(aplus(sa.groups5)),add=T,col="green",pch=20)
> mean(cdata - mean(cdata))
[1] "   1" "   1" "   1" "   1" "   1"
attr(,"class")
[1] "aplus"
> 
> cdata <- rplus(mydata)
> cdata
      Cu             Zn             Pb            Cd             Co           
 [1,] "  2.32560998" "   3.2957280" " 80.8863102" "  0.94398005" " 3.01216337"
 [2,] "  0.05819293" "   0.7845092" " 13.9470095" "  1.07860821" " 4.74119583"
 [3,] "  0.30402525" "   2.0801748" " 16.5920669" "<0.01000000"  "<0.01000000"
 [4,] "  2.90108035" "         MAR" " 75.7082851" "  0.09567857" " 0.23287289"
 [5,] "  5.74951568" "  11.9270845" "166.4079616" "        MNAR" " 0.02851976"
 [6,] "  3.09984060" "   4.3171470" " 25.4672180" "          SZ" "        MAR"
 [7,] "  2.95684364" "  14.1135236" " 47.8578897" "  0.06234571" " 0.11773265"
 [8,] "  3.06234225" "  26.4777503" "172.8517697" "  0.36094134" " 0.69904915"
 [9,] "  3.08324786" "  11.2929712" "116.4095761" "         MAR" " 0.09328223"
[10,] "  2.07666904" "   8.1928484" " 33.4085541" "  0.21748113" " 0.89242687"
[11,] "  8.00279898" "  31.8616572" "223.4768193" "<0.01000000"  " 0.04142996"
[12,] "  0.79144603" "   1.9146573" "165.9778114" "  0.13950902" " 0.39622464"
[13,] "  0.77908829" "   1.8777502" "103.9052563" "        MNAR" "<0.01000000"
[14,] "  0.41623431" "   1.7912103" " 25.0992607" "        MNAR" "         SZ"
[15,] "  3.20107658" "   5.7130820" "115.6421587" "  0.14943429" " 0.36550397"
[16,] "  8.12173391" "   8.6616754" "  8.0213387" "  0.98158755" " 1.61092791"
[17,] "  3.34773718" "   5.2036119" "        MAR" "         MAR" " 4.90634916"
[18,] "  3.90181325" "   6.7375485" " 80.7026878" "  0.07636845" " 0.37236699"
[19,] "  2.89945563" "   7.9866066" " 62.8867060" "  0.22138159" " 0.51536549"
[20,] "  6.56268069" "  15.8964079" " 12.3310390" "  1.52994294" " 2.30691173"
[21,] " 17.07806483" "  29.5416217" "  2.6866388" "        MNAR" "<0.01000000"
[22,] "        MNAR" "   4.3183778" " 14.7250399" "        MNAR" " 0.01695507"
[23,] " 20.54410986" "  29.2260393" "  1.1256909" "  0.03904026" "         SZ"
[24,] "          SZ" "  35.4935764" "         SZ" "  0.23070396" " 0.07642094"
[25,] " 16.10576105" "  41.2241264" "  4.5121791" "         MAR" " 0.24453498"
[26,] " 22.77938611" "  55.7343791" " 17.1622383" "  0.10950726" "       MNAR"
[27,] " 23.58064507" "          SZ" "  4.9811298" "  0.37948663" "       MNAR"
[28,] "  1.83244165" "   7.2708966" " 15.7735623" "        MNAR" " 0.04787820"
[29,] "  7.24766118" "  12.2194998" " 18.0697375" "<0.01000000"  "<0.01000000"
[30,] "  7.63069488" "  27.4527504" "  7.0216935" " 10.91983495" " 2.60794446"
[31,] " 26.62950316" " 206.2999218" "  6.4004535" "          SZ" " 0.32257893"
[32,] "         MAR" "  22.4674773" "  9.3982004" "  1.60457988" " 0.58409817"
[33,] "  0.81109644" "   4.9437589" " 41.6073436" "  0.15183519" " 0.03069441"
[34,] "         MAR" "  33.5325182" " 27.0742554" "  0.02930429" "<0.01000000"
[35,] "  4.55079806" "  15.1956755" "  5.6001961" "         MAR" "<0.01000000"
[36,] "  4.97063214" "   8.4395369" " 12.3543088" "  0.27112180" " 0.14126952"
[37,] "  2.20930598" "   9.6117618" "  7.4436580" "  0.05524286" " 0.03597626"
[38,] " 16.70681690" "  11.8629313" " 72.3687834" "<0.01000000"  "<0.01000000"
[39,] " 14.48399049" "  46.5499617" " 12.1470616" "         MAR" "        MAR"
[40,] "  3.66342116" "   7.0294182" "         SZ" "  0.85553525" "         SZ"
[41,] " 10.95300809" "  48.8473197" "  0.8176742" "  0.22019960" " 0.02808624"
[42,] "         MAR" " 615.2700400" "  1.2416628" "        MNAR" "       MNAR"
[43,] "  3.89677070" "  30.9201450" "  4.6745093" "  0.12031465" " 0.02860023"
[44,] " 19.81539452" " 117.8198968" "  5.0032936" "207.88485371" "         SZ"
[45,] " 13.87302392" " 304.4366853" "  0.6038472" "  4.43805373" " 0.60132928"
[46,] " 11.75363784" " 241.9119212" "  1.8343449" "  0.13896191" " 0.02249354"
[47,] "          SZ" "  80.2172745" "  1.4125437" "  3.62082849" "       MNAR"
[48,] "  5.03541513" " 102.7159212" "  1.6075940" "          SZ" "12.50538258"
[49,] "  5.79177975" " 140.0511873" "  1.1905213" "  1.72381849" " 0.23100839"
[50,] "104.59774771" " 684.4994158" "  0.1841582" "  0.04707184" "<0.01000000"
[51,] "  6.42154600" "  64.8076064" "  1.0885176" "  7.15094526" " 1.30139867"
[52,] " 60.77708084" "1226.1573067" "  1.0725284" "  2.47041878" " 0.22030942"
[53,] " 66.57712168" " 585.3091893" "  3.7336819" "  0.23120261" " 0.05465156"
[54,] " 16.86023960" "  88.5219277" "  0.6310446" "          SZ" "       MNAR"
[55,] "  6.27202842" "  39.0967097" "  0.7076713" " 36.11544583" " 5.22807356"
[56,] " 58.91700620" " 446.8664238" "  0.1996731" "  4.94016780" " 0.49932471"
[57,] " 33.98383856" " 384.6450147" "  0.3375277" "  0.02547720" "       MNAR"
[58,] "  3.74675153" " 107.4109817" "  1.3340243" "          SZ" "<0.01000000"
[59,] "  7.16929149" " 161.0791359" "        MAR" "  4.23335288" " 0.65084480"
[60,] " 26.39789963" "         MAR" "  0.7417621" " 54.23829107" " 8.22249084"
attr(,"class")
[1] "rplus"
> mean(cdata)
[1] " 12.809024" "107.743522" " 32.007732" "  7.252143" "  1.039128"
attr(,"class")
[1] "rplus"
Warning message:
In sumMissingProjector.rplus(.orig) :
  sumMissingProjector.rplus: There is no established theory available for missings in nonrelative positive geometry. Results are experimental. 
> mean(rplus(sa.groups5))
          Cu           Zn           Pb           Cd           Co 
" 13.183423" "121.515630" " 31.862701" "  6.996818" "  1.399201" 
attr(,"class")
[1] "rplus"
> plot(rplus(sa.groups5))
> plot(mean(cdata),add=T,col="red",pch=20)
Warning message:
In sumMissingProjector.rplus(.orig) :
  sumMissingProjector.rplus: There is no established theory available for missings in nonrelative positive geometry. Results are experimental. 
> plot(mean(rplus(sa.groups5)),add=T,col="green",pch=20)
> mean(cdata - mean(cdata)) # Nonsense because the difference is non compositonal
Warning message:
In sumMissingProjector.rplus(.orig) :
  sumMissingProjector.rplus: There is no established theory available for missings in nonrelative positive geometry. Results are experimental. 
> 
> 
> plot(acomp(mydata))
There were 50 or more warnings (use warnings() to see the first 50)
> plot(aplus(mydata))
> plot(rcomp(mydata))
> plot(rplus(mydata))
> 
> boxplot(acomp(mydata))
There were 22 warnings (use warnings() to see them)
> boxplot(aplus(mydata))
> boxplot(rcomp(mydata))
Warning message:
In acomp(x) : Negative values in composition are used as detection limits
> boxplot(rplus(mydata))
> 
> barplot(acomp(mydata))
Warning message:
In acomp(mydata) :
  Negative values in composition are used as detection limits
> barplot(aplus(mydata))
> barplot(rcomp(mydata))
> barplot(rplus(mydata))
> 
> proc.time()
   user  system elapsed 
  4.314   0.761   4.253 
